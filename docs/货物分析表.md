# 货物分析表文档

## 概述

货物分析表是一个包含三个工作表(Sheet)的Excel文档，用于记录和分析项目中的货物信息。本文档详细描述了每个工作表的结构和识别规则，特别是基于颜色的表格识别方法。

## 工作表结构

### 1. 封面

封面工作表包含项目的基本信息，如公司名称、项目名称等元数据信息。

### 2. 屏柜汇总表

屏柜汇总表提供项目屏柜的整体汇总信息，包含各屏柜的总体数据和统计信息。

### 3. 屏柜分项表

屏柜分项表是核心工作表，包含详细的屏柜分项数据。以下是其详细结构：

## 屏柜分项表详细结构

### 表格区域划分

屏柜分项表从第11行开始（Excel中显示的行数）为实际数据区域，前10行为表头信息区域。

**实际文件结构验证**：
- 文件总行数：286行
- 表头信息区域：第1-10行
- 数据区域：第11-286行

### 数据行识别规则

#### 1. 项目编号行
- **位置**: 第11行
- **特征**:
  - 背景颜色: RGB(198, 239, 206) - 浅绿色
  - 内容格式: 项目编号（如：G00E-500009085-00011）
  - 单元格合并: 从A列合并到K列，占据整行
  - **实际验证**: ✅ 日志显示第11行为 `G00E-500009085-00011`
- **识别方式**: 通过浅绿色背景识别

#### 2. 柜号行
- **位置**: 项目编号行的下一行
- **特征**:
  - 背景颜色: RGB(127, 150, 152) - 灰蓝色
  - 或通过B列文本识别：包含"柜号:"文本
  - **实际验证**: ✅ 日志显示第12行为 `1-1`, `柜号：直流充电柜`, `名称：`, `直流充电柜`
- **识别方式**: 通过灰蓝色背景或B列"柜号:"文本识别

#### 3. 表头行
- **位置**: 柜号行的下一行
- **特征**:
  - 背景颜色: RGB(217, 217, 217) - 浅灰色
  - 内容格式: "序号	元件名称	型号规格	产地	生产厂家	单位	数量	单价	总价		备注"
  - **实际验证**: ✅ 日志显示第13行完全匹配此格式
- **识别方式**: 通过浅灰色背景识别

#### 4. 数据行
- **位置**: 表头行之后
- **特征**:
  - 背景颜色: 无颜色（白色）
  - 数量: 不固定，根据实际数据而定
  - 内容: 具体的元件信息
  - **实际验证**: ✅ 日志显示第14-40行为具体元件数据，包含序号、元件名称、型号规格、产地、生产厂家、单位、数量、单价、总价等
- **识别方式**: 通过无背景色识别，位于表头行和合计行之间

#### 5. 合计行
- **位置**: 数据行之后
- **特征**:
  - 背景颜色: RGB(255, 204, 253) - 浅粉色
  - 类型: 分为"单台合计"和"小计"两种
  - **实际验证**: ✅ 日志显示多个合计行：
    - 第41行: `小计: 16889.01`
    - 第42行: `单台合计: 16889.01`
    - 第50行: `小计: 19092.32`
    - 第51行: `单台合计: 19092.32`
  - 识别要求: 需要分开识别，不合并处理
- **识别方式**: 通过浅粉色背景识别，并区分"单台合计"和"小计"

## 颜色识别汇总

| 行类型 | RGB颜色值 | 颜色描述 | 识别特征 |
|--------|-----------|----------|----------|
| 项目编号行 | (198, 239, 206) | 浅绿色 | 合并单元格，项目编号格式 |
| 柜号行 | (127, 150, 152) | 灰蓝色（近似） | 或B列包含"柜号:"文本 |
| 表头行 | (217, 217, 217) | 浅灰色 | 固定列标题格式 |
| 数据行 | 无颜色 | 白色 | 位于表头和合计之间 |
| 合计行 | (255, 204, 253) | 浅粉色 | 分为"单台合计"和"小计" |

## 表格结构示意图

```
行1-10: 表头信息区域（公司名称、项目名称等）
行11:   [项目编号行] - 浅绿色背景，合并单元格
行12:   [柜号行] - 灰蓝色背景，或B列"柜号:"文本
行13:   [表头行] - 浅灰色背景，列标题
行14-40: [数据行] - 白色背景，具体元件信息（第一个柜组）
行41:   [小计行] - 浅粉色背景，第一个柜组小计
行42:   [单台合计行] - 浅粉色背景，第一个柜组合计
行43:   [总计行] - 浅粉色背景，第一个柜组总计

行44-52: [数据行] - 白色背景，具体元件信息（第二个柜组）
行50:   [小计行] - 浅粉色背景，第二个柜组小计
行51:   [单台合计行] - 浅粉色背景，第二个柜组合计
行52:   [总计行] - 浅粉色背景，第二个柜组总计

行53-286: [多个柜组数据] - 重复上述模式，包含多个柜组的详细数据
```

## 实际文件结构分析

### 发现的柜组模式
根据日志分析，该Excel文件包含多个柜组，每个柜组遵循相同的结构模式：

1. **第一个柜组（直流充电柜）**
   - 项目编号: G00E-500009085-00011
   - 柜号: 1-1, 直流充电柜
   - 数据行: 第14-40行（27行数据）
   - 小计: 16889.01元
   - 单台合计: 16889.01元

2. **第二个柜组（直流电池柜）**
   - 项目编号: G00E-500009078-00005
   - 柜号: 1-2, 直流电池柜
   - 数据行: 第46-52行（7行数据）
   - 小计: 19092.32元
   - 单台合计: 19092.32元

3. **后续柜组**
   - 包含多个类似结构的柜组
   - 每个都有独立的项目编号、柜号、数据行和合计

### 元件类型统计
- **监控类**: 直流监控、一体化监控、通信监控等
- **断路器类**: 交流微型断路器、直流微型断路器、直流塑壳断路器等
- **电源模块**: 高频开关电源模块、通信电源模块等
- **保护装置**: 电涌保护器、双电源切换装置等
- **仪表类**: 交流电压表、直流电压表、直流电流表等
- **其他**: 指示灯、辅材、柜体等

## 处理建议

1. **颜色识别优先**: 使用RGB颜色值作为主要识别依据，确保准确性
2. **备用识别方式**: 对于柜号行，提供文本识别作为备用方案
3. **合计行分离**: 单独处理"单台合计"和"小计"，不合并识别
4. **动态数据行**: 数据行数量不固定，需要动态识别起始和结束位置
5. **多柜组处理**: 识别并分离不同的柜组数据，每个柜组有独立的项目编号和合计
6. **实际颜色读取**: 当前实现使用模拟颜色，需要实现真实的Excel样式读取功能

## 注意事项

- 所有颜色值均为RGB格式，在编程实现时需注意颜色空间的转换
- 合并单元格在处理时需要特殊处理，避免重复读取
- 表格结构可能因项目不同而略有差异，建议增加容错机制

输出文件内容结构:
独属于货物分析表功能输出文件的头部信息
第1行: ["货物清单单价分析表", "", "", "", "", "", "", "", "", ""]
第2行: ["分标编号:1225AA-1109001-9999             包号:包2", "", "", "", "", "", "", "", "", ""]
第3行: ["项目名称：国网安徽电力2025年第一批省公司配网协议库存项目包", "", "", "", "", "", "", "金额单位：人民币万元", "", ""]
第4行: ["序号", "组件材料费用项目名称", "", "产地", "制造商", "单位", "数量", "单价\n(含税)", "合价\n(含税)", "备注"]
第5行: ["一", "主设备", "", "", "", "", "", "", "", ""]
下面的这个就是尾部信息呀
第37行: ["二", "其他组件材料", "无", "", "", "", "", "无", "无", ""]
第38行: ["三", "其他费用\n(运输培训设计联络现场服务等)", "", "", "", "", "", "免", "免", ""]
第39行: ["四", "合计金额\n(单位完整货物单价)", "", "", "", "", "", "", "2.342", ""]
第40行: ["五", "本工程项目（共计需求1套）  总价为", "", "", "", "", "", "", "2.342", ""]